<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>大人向けノベルゲームサンプル</title>
<style>
  body {
    font-family: "Noto Sans JP", sans-serif, sans-serif;
    background: #1a1a1a;
    color: #f0d9e6;
    margin: 0; padding: 1em;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100vh;
    box-sizing: border-box;
  }
  #game-container {
    max-width: 600px;
    width: 100%;
    background: #330029;
    border-radius: 12px;
    padding: 1em 1.5em;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    height: 100%;
    box-shadow: 0 0 20px #ff4da6;
  }
  #character-img {
    max-width: 100%;
    height: auto;
    border-radius: 12px;
    margin-bottom: 1em;
    user-select: none;
  }
  #text {
    flex-grow: 1;
    font-size: 1.3em;
    line-height: 1.7em;
    white-space: pre-wrap;
    margin-bottom: 1.2em;
    letter-spacing: 0.05em;
  }
  #choices {
    display: flex;
    flex-direction: column;
    gap: 14px;
  }
  button {
    font-size: 1.3em;
    padding: 15px 22px;
    border-radius: 10px;
    border: none;
    background: #ff66b2;
    color: #330029;
    cursor: pointer;
    transition: background-color 0.3s;
    user-select: none;
    font-weight: bold;
    box-shadow: 0 0 10px #ff66b2;
  }
  button:hover {
    background: #e64ca9;
  }
  button:active {
    background: #b33a7a;
  }
</style>
</head>
<body>

<div id="game-container">
  <img id="character-img" src="" alt="" style="display:none;">
  <div id="text"></div>
  <div id="choices"></div>
</div>

<script>
// キャラ画像URL（サンプルイラストをフリー素材や仮で用意）
const characters = {
  saya: "saya.png",       // 優しい女性キャラ
  player: "https://i.imgur.com/qfVGhYT.png",     // 主人公
  boss: "https://i.imgur.com/VF6HwDx.png",       // 上司
  customer: "https://i.imgur.com/YYp4pV8.png"    // お客様（追加）
};

// 好感度管理
let affection = 0;

// ストーリー配列
const story = [
  {
    text: "夜のカフェ『Café Lune』へようこそ。\n今日からあなたはこの大人の隠れ家でアルバイトを始める。",
    character: null,
    choices: null
  },
  {
    text: "霧島 紗耶『いらっしゃい。あなたが新人の…頼りにしてるわよ』\n彼女の微笑みはどこか艶めかしい。",
    character: "saya",
    choices: null
  },
  {
    text: "どう返事する？",
    character: "saya",
    choices: [
      { text: "よろしくお願いします…緊張しますね", next: 3, affectionChange: 1 },
      { text: "……ここ、変わった店ですね？", next: 4, affectionChange: -1 }
    ]
  },
  {
    text: "あなた『よろしくお願いします…緊張しますね』\n紗耶は少し頬を染めて、優しく手を握ってくれた。",
    character: "saya",
    choices: [
      { text: "もっと話す", next: 5 },
      { text: "仕事に集中する", next: 6 }
    ]
  },
  {
    text: "あなた『……ここ、変わった店ですね？』\n紗耶は微笑んで、『そう、普通じゃないの』とウィンクした。",
    character: "saya",
    choices: [
      { text: "納得できない", next: 7, affectionChange: -1 },
      { text: "それでも頑張る", next: 6 }
    ]
  },
  {
    text: "紗耶『私がいるから安心して』\nその言葉に胸が熱くなる。仕事への不安が少し和らいだ。",
    character: "saya",
    choices: null
  },
  {
    text: "上司の山田が厳しく指示を出す。\nでも、紗耶の励ましでなんとか乗り越えられそうだ。",
    character: "boss",
    choices: [
      { text: "頑張る", next: 8, affectionChange: 1 },
      { text: "逃げたい", next: 9 }
    ]
  },
  {
    text: "紗耶『私もあなたに秘密があるの。夜の店は特別な場所よ』\nその言葉にどきりとした。",
    character: "saya",
    choices: [
      { text: "もっと聞きたい", next: 10, affectionChange: 1 },
      { text: "怖い", next: 9, affectionChange: -1 }
    ]
  },
  {
    text: "あなたは疲れて帰ろうとした。\nでも外は冷たく、また戻る気力が湧かなかった。",
    character: null,
    choices: [
      { text: "もう一度チャレンジ", next: 2 },
      { text: "諦めて帰る", next: 11 }
    ]
  },
  {
    text: "紗耶はあなたの手を握り、そっと唇にキスを落とした。\nその温もりに心が震えた。",
    character: "saya",
    choices: null
  },
  {
    text: "店を離れたあなたは、夜の街灯に照らされて一人歩いた。\nまた来る日は来るのだろうか…",
    character: null,
    choices: [
      { text: "ゲームを最初からやり直す", next: 0 }
    ]
  }
];

// 現在のストーリー位置
let currentIndex = 0;

function showText() {
  const textDiv = document.getElementById("text");
  const choicesDiv = document.getElementById("choices");
  const charImg = document.getElementById("character-img");
  choicesDiv.innerHTML = "";

  const current = story[currentIndex];

  textDiv.textContent = current.text;

  // キャラ画像表示
  if(current.character && characters[current.character]) {
    charImg.src = characters[current.character];
    charImg.style.display = "block";
    charImg.alt = current.character;
  } else {
    charImg.style.display = "none";
    charImg.src = "";
    charImg.alt = "";
  }

  // 好感度変化
  if(current.choices && current.choices.length > 0) {
    current.choices.forEach(choice => {
      const btn = document.createElement("button");
      btn.textContent = choice.text;
      btn.onclick = () => {
        if(typeof choice.affectionChange === "number") {
          affection += choice.affectionChange;
          // 好感度は0～10の範囲に制限
          affection = Math.min(Math.max(affection, 0), 10);
        }
        currentIndex = choice.next;
        showText();
      };
      choicesDiv.appendChild(btn);
    });
  } else {
    const btn = document.createElement("button");
    btn.textContent = "つづける";
    btn.onclick = () => {
      if(currentIndex + 1 < story.length) {
        currentIndex++;
        showText();
      } else {
        currentIndex = 0;
        affection = 0;
        showText();
      }
    };
    choicesDiv.appendChild(btn);
  }
}

showText();
</script>

</body>
</html>
